---
category: shader
tags: [U3D, Shader,Cookbook,中文版]
---

## 第六章 片元着色器和抓取通道   

到目前为止，我们都在折腾**表面着色器（Surface Shaders）**。它的设计初衷是简化我们的着色器编码工作，为艺术家提供一个有意义的工具。但是如果想让我们的着色器知识更上一层楼，我们就要前往**顶点（Vertex）**和**片元（Fragment）**着色器的知识岛屿冒险啦。   
<br>
在这一章节，我们将会学习下面的一些知识点：   
- 理解顶点和片元着色器
- 使用抓取通道
- 实现一个玻璃效果的着色器
- 在2D游戏中实现水效果的着色器   

***  

### 介绍   
跟**表面着色器（Surface Shaders）**相比，**顶点**和**片元**着色器少了一些诸如，光是如何在物体表面反射的物理属性信息。所谓有失必有得，这样的话顶点和片元着色器就没有了物理规则的限制并且特别适合实现非真实的效果。这个章节将集中讲抓取通道的技术，这些技术可以让着色器来模拟形变效果。   


*** 

## 理解顶点和片元着色器   
理解顶点和片元着色器最好的方法就是你自己亲自创建一个。在这个知识点我们将展示如何编写一个这样的着色器，该着色器简单的将一张纹理应用到一个模型上并且通过给定的颜色进行乘积运算，效果就如同下图一样：   
![diagram](https://linkliu.github.io/game-tech-post/assets/img/shader_book/diagram69.png){:  .shadow width = "90%" }   
<br>
这里展示的着色器非常的简单，只是作为学习其他顶点和片元着色器基础。

***   

- **始前准备**   
  对于这个知识点，我们将需要一个新的着色器。我们按照下面的步骤来：   
  - 1.创建一个新的着色器。
  - 2.创建一个新的材质并且把着色器应用于该材质。


*** 

- **操作步骤**   
  在前面的所有章节中，我们总是能在**表面着色器（Surface Shaders）**的基础上进行修改。但在这里就不能再那样做了，因为表面着色器和片元着色器在结构上是不一样的。我们需要做如下的修改：   
  1. 删除着色器上的所有属性，然后用下面的属性替换：
    ``` c#
    Color ("Color", Color) = (1,0,0,1) // Red
    _MainTex ("Base texture", 2D) = "white" {}
    ```
  2. 删除 **SubShader** 块中的所有代码，然后用下面的代码替换：
    ``` c#
    Pass 
	{
		CGPROGRAM
		#pragma vertex vert
		#pragma fragment frag
		half4 _Color;
		sampler2D _MainTex;
		struct vertInput 
		{
			float4 pos : POSITION;
			float2 texcoord : TEXCOORD0;
		};
		struct vertOutput 
		{
			float4 pos : SV_POSITION;
			float2 texcoord : TEXCOORD0;
		};
		vertOutput vert(vertInput input) 
		{
			vertOutput o;
			o.pos = UnityObjectToClipPos(input.pos);
			o.texcoord = input.texcoord;
			return o;
		}
		half4 frag(vertOutput output) : COLOR
		{
			half4 mainColour = tex2D(_MainTex, output.texcoord);
			return mainColour * _Color;
		}
		ENDCG 
	}
    ```   
    后面所有的顶点和片元着色器都会以此为基础。


